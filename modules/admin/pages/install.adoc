// tag::linux[]
:of: модуля
:wt: workflow

= Установка и настройка СУБП

include::install-linux::partial$limitation.adoc[]

[#linux]
== Установка на Linux

include::6.1platform:admin:partial$install.adoc[]
+
Основные настройки, которые нужно сделать:
+
--
[source,json]
----
{
  "Docsvision": {
    "Workflow": {
      "ServiceUrl": "http://dvserver.domain.com:5000/api/v1", <.>
      "BaseName": "alias", <.>
      "WorkflowServer": {
        <.>
      }
    }
  },
  "DataProtectCertificateThumbprint": "thumbprint", <.>
  "SystemUserAccount": "account@domain.com", <.>
  "SystemUserPassword": "password", <.>
  "APIKEY": "api-key" <.>
}
----
<.> Адрес сервера {dv}. Обратите внимание на api/v1 в адресе.
<.> Псевдоним БД {dv}.
<.> Настройки почты, подробнее см. раздел "xref:6.1@workflow:admin:mail-settings.adoc[]".
<.> Отпечаток закрытого ключа шифрования SHA1. +
Указывается без двоеточия, например, `D8602179888DC8402B393F11DCA16A3376DDF879`, см. подробнее в документации по установке системы, раздел "xref:install-linux::appendix/account-protection.adoc[]". +
Если шифровать пароль системной учётной записи не планируется, параметр можно удалить.
<.> Имя системной учётной записи {dv}.
<.> Пароль системной УЗ, рекомендуется хранить в зашифрованном виде, см. подробнее в документации по установке системы, раздел "xref:install-linux::appendix/account-protection.adoc[]".
+
include::6.1@platform:ROOT:partial$excerpts.adoc[tags=system-accounts]
+
<.> Используется для аутентификации в API {wf}. Можно оставить значение по умолчанию или изменить, главное условие, чтобы значения в конфигурации модулей {pl} и {wf} были одинаковые.
--
// end::linux[]

[#windows]
== Установка на Windows

. Пакет установки серверной части модуля: `{dv} Workflow server.msi`.
. Пакет установки клиентской части модуля: `{dv} Workflow client.msi`.

В данном разделе перечислены действия, которые должны быть выполнены перед установкой серверной части модуля.

[#account]
== Создание учетной записи для сервиса Workflow

Администратор должен создать учетную запись для СУБП, службы *{wfs-new}*.

.Создайте доменную учетную запись, и настройте её права:
. На сервере Linux включите учетную запись в локальные группы _{dv-power-users-serv}_.
// и _Performance Monitor Users_.
Группы настраиваются в конфигурационном файле модуля {pl}, подробнее см. в документации модуля {pl}, раздел "xref:6.1@platform:admin:config-platform.adoc[]".
. На компьютере с серверной частью модуля:
+
* Включите учетную запись в локальную группу *Users*.
// * https://social.technet.microsoft.com/Forums/ie/en-US/a6fcbe72-6f75-4bd2-bb96-440e2c8913c2/how-do-i-configure-a-user-account-to-have-8216logon-as-a-service8217-permissions?forum=winserverGP[Предоставьте] право _Log on as service_ в локальной политике безопасности.
// * Предоставьте права на чтение и запись в ветку реестра `{hklm-dv}\Workflow`.

[start=2]
.После настройки системы {dv}:
. Предоставьте созданной учетной записи *полные* права по дискреционной модели безопасности на все папки и справочники системы {dv}.
. Для работы с карточками приложения _{dm}_, включите учётную запись в группу *{dv-sys-wf-dir}* в Справочнике сотрудников.
. Назначьте учетной записи персональную лицензию в {dv} (см. документацию модуля "xref:6.1@platform:console:manage-licenses.adoc#personalLicense[{pl}]".

[#server]
== Установка серверной части модуля

Серверная часть модуля _{wf}_ должна быть установлена на компьютер с сервером {dv}.

Пользователь, выполняющий установку, должен обладать правами локального администратора и являться _администратором {dv}_ (быть членом группы *{dv-admins-serv}* на компьютере с сервером {dv}).

. Запустите пакет установки `{dv} Workflow server.msi`.
+
.Мастер установки серверной части модуля {wf}
image::install-hello-server.png[Мастер установки серверной части модуля {wf}]
+
. Примите предложенные условия лицензионного соглашения для продолжения установки.
+
.Условия лицензионного соглашения
image::install-license-server.png[Условия лицензионного соглашения]
+
. Нажмите на кнопку *Установить* и дождитесь завершения установки модуля.
+
.Начало установки серверной части модуля {wf}
image::install-confirm.png[Начало установки серверной части модуля {wf}]
+
. На следующем экране нажмите кнопку *Готово*, чтобы закрыть мастер установки.
+
include::install-linux:ROOT:partial$restart-and-db.adoc[]

[#client]
== Установка клиентской части модуля

Клиентская часть модуля _{wf}_ должна быть установлена на компьютеры пользователей {dv}, если есть потребность в использовании {wincl}а.

.Клиентская часть модуля может быть установлена двумя способами:
* Автоматически -- требуемые компоненты будут загружены с сервера {dv} и установлены автоматически.
* Вручную -- администратор должен самостоятельно установить клиентскую часть модуля _{wf}_.

Модуль будет установлен в каталог установки и с областью установки модуля {pl} -- у пользователя должны быть права на установку с данными условиями.

[#auto-client]
=== Автоматическая установка клиентской части модуля _{wf}_

Запустите {wincl}. При подключении к серверу {dv}, на котором установлена серверная часть модуля _{wf}_, клиентская часть модуля будет установлена автоматически.

NOTE: Если клиентская часть модуля _{pl}_ установлена с областью установки "для всех пользователей", {wincl} нужно запустить с правами локального администратора.

[#manual-client]
=== Установка клиентской части модуля _{wf}_ из установочного пакета

. Запустите пакет установки `{dv} Workflow client.msi`.
+
.Мастер установки клиентской части модуля {wf}
image::install-hello-client.png[Мастер установки клиентской части модуля {wf}]
+
Для установки клиентской части модуля используются область и каталог установки, указанные в конфигурационном файле модуля {pl}, см. документацию модуля {pl} xref:6.1@platform:console:config-client.adoc[].
// используется область установки (указана в приветственном окне мастера установки) и каталог установки, которые были использованы при установке модуля {pl}.
. Примите условия лицензионного соглашения для продолжения установки.
+
.Условия лицензионного соглашения
image::install-license-client.png[Условия лицензионного соглашения]
. Нажмите на кнопку *Установить* и дождитесь завершения установки модуля.
+
.Начало установки клиентской части модуля {wf}
image::install-confirm-client.png[Начало установки клиентской части модуля {wf}]
+
Для установки с областью установки "для всех пользователей" требуются права локального администратора.
+
. Нажмите на кнопку *Готово*, чтобы закрыть мастер установки.

[#uninstall]
== Удаление модуля

. Чтобы удалить модуль в ОС Linux, выполните команду:
+
include::6.1platform:admin:partial$delete.adoc[]
+
Компоненты модуля следует удалять до удаления компонентов модуля _{pl}_.
+
. В ОС Windows компоненты модуля удаляются стандартными средствами.
